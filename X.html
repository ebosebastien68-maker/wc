<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Bulk Reactions ‚Äî X</title>
<style>body{font-family:Arial;padding:18px}input,button{padding:10px;margin:6px 0}button{background:#11998e;color:#fff;border:none;border-radius:6px}</style>
</head>
<body>
<h2>Ajout instantan√© de r√©actions</h2>
<label>Article ID</label><br/>
<input id="articleId" type="text" placeholder="ee2abbde-..." style="width:60%"/><br/>
<label>Like</label><input id="like" type="number" value="0"/><br/>
<label>Love</label><input id="love" type="number" value="0"/><br/>
<label>Rire</label><input id="rire" type="number" value="0"/><br/>
<label>Col√®re</label><input id="colere" type="number" value="0"/><br/>
<button id="run">üöÄ Ex√©cuter</button>
<pre id="out" style="background:#f3f3f3;padding:12px;border-radius:6px;margin-top:12px;display:none"></pre>

<script>
const EDGE_URL = 'https://eqnvbmkdrnssbiwalocr.supabase.co/functions/v1/add-reactions-bulk-';
const JWT = 'YOUR_ANON_OR_TEMP_JWT'; // remplace par ta cl√© anon ou JWT temporaire

const out = document.getElementById('out');
function print(obj){ out.style.display='block'; out.textContent = JSON.stringify(obj, null, 2); }

document.getElementById('run').addEventListener('click', async () => {
  out.style.display='none';
  const article_id = document.getElementById('articleId').value.trim();
  const like = Number(document.getElementById('like').value) || 0;
  const love = Number(document.getElementById('love').value) || 0;
  const rire = Number(document.getElementById('rire').value) || 0;
  const colere = Number(document.getElementById('colere').value) || 0;
  if (!article_id) return alert('Article ID requis');
  if (like+love+rire+colere===0) return alert('Entrez au moins une r√©action');
  try {
    const resp = await fetch(EDGE_URL, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${JWT}`,
        'apikey': JWT
      },
      body: JSON.stringify({ article_id, reactions: { like, love, rire, colere } })
    });
    const txt = await resp.text();
    try{ print(JSON.parse(txt)); } catch(e){ print(txt); }
    if (!resp.ok) throw new Error('HTTP '+resp.status);
  } catch (err) {
    print({ error: String(err) });
    console.error(err);
  }
});
</script>
</body>
</html>
